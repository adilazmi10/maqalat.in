<script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    const SUPABASE_URL = 'https://npnjpcwqmfwwviqlwrvw.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5wbmpwY3dxbWZ3d3ZpcWx3cnZ3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMxMTMyMzMsImV4cCI6MjA2ODY4OTIzM30.EEbXf-xsonUjvE0DZBOGcG9EU97aGNSUc6MRTEE40pU'; 
    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

    async function loadArticle() {
        const params = new URLSearchParams(window.location.search);
        const id = params.get("id");

        if (!id) {
            document.getElementById("article-title").innerText = "Invalid Article ID";
            return;
        }

        const { data, error } = await supabase
            .from("articles")
            .select(`
                id,
                title,
                content,
                reference,
                authors(name),
                categories(name)
            `)
            .eq("id", id)
            .single();

        if (error || !data) {
            console.error("Supabase error:", error);
            document.getElementById("article-title").innerText = "Article not found";
            document.getElementById("article-content").innerHTML = "";
            return;
        }

        document.getElementById("article-title").innerText = data.title;
        document.getElementById("article-content").innerHTML = data.content;
        document.getElementById("article-author").innerText = data.authors?.name || "Unknown";
        document.getElementById("article-category").innerText = data.categories?.name || "Uncategorized";
    }

    document.addEventListener("DOMContentLoaded", loadArticle);
</script>
